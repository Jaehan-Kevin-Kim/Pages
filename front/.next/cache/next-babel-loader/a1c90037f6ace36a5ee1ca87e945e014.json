{"ast":null,"code":"import Router from \"next/router\";\nimport Head from \"next/head\";\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport AppLayout from \"../components/AppLayout\";\nimport FollowerList from \"../components/FollowerList\";\nimport FollowList from \"../components/FollowList\";\nimport useSWR from \"swr\";\nimport NicknameEditForm from \"../components/NicknameEditForm\";\nimport { LOAD_FOLLOWERS_REQUEST, LOAD_FOLLOWINGS_REQUEST } from \"../reducers/user\";\nimport axios from \"axios\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nvar fetcher = function fetcher(url) {\n  return axios.get(url, {\n    withCredentials: true\n  }).then(function (result) {\n    return result.data;\n  });\n};\n\nvar profile = function profile() {\n  // const followerList = [{ nickname: \"kevin\" }, { nickname: \"sample\" }, { nickname: \"admin user\"}];\n  // const followingList = [{ nickname: \"kevin\" }, { nickname: \"sample\" }, { nickname: \"admin\" }];\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useState = useState(3),\n      followersLimit = _useState[0],\n      setFollowersLimit = _useState[1];\n\n  var _useState2 = useState(3),\n      followingsLimit = _useState2[0],\n      setFollowingsLimit = _useState2[1];\n\n  var _useSWR = useSWR(\"http://localhost:3065/user/followers?limit=\".concat(followersLimit), fetcher),\n      followersData = _useSWR.data,\n      followerError = _useSWR.error;\n\n  var _useSWR2 = useSWR(\"http://localhost:3065/user/followings?limit=\".concat(followingsLimit), fetcher),\n      followingsData = _useSWR2.data,\n      followingError = _useSWR2.error; // useEffect(() => {\n  //   dispatch({\n  //     type: LOAD_FOLLOWERS_REQUEST,\n  //   });\n  //   dispatch({\n  //     type: LOAD_FOLLOWINGS_REQUEST,\n  //   });\n  // }, []);\n\n\n  useEffect(function () {\n    if (!(me && me.id)) {\n      Router.push(\"/\");\n    }\n  }, [me && me.id]);\n  var loadMoreFollowings = useCallback(function () {\n    setFollowingsLimit(function (prev) {\n      return prev + 3;\n    });\n  }, []);\n  var loadMoreFollowers = useCallback(function () {\n    setFollowersLimit(function (prev) {\n      return prev + 3;\n    });\n  }, []);\n\n  if (!me) {\n    return \"Loading my info...\";\n  }\n\n  if (followerError || followingError) {\n    console.error(followerError || followingError);\n    return \"Error occurs during following or follower action\";\n  }\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"My Profile | Poster\"\n      })\n    }), /*#__PURE__*/_jsxs(AppLayout, {\n      children: [/*#__PURE__*/_jsx(NicknameEditForm, {}), /*#__PURE__*/_jsx(FollowList, {\n        header: \"Following List\",\n        data: followingsData,\n        onClickMore: loadMoreFollowings,\n        loading: !followingsData && !followingError\n      }), /*#__PURE__*/_jsx(FollowList, {\n        header: \"Follower List\",\n        data: followersData,\n        onClickMore: loadMoreFollowers,\n        loading: !followersData && !followerError\n      })]\n    })]\n  });\n};\n\nexport var __N_SSP = true;\nexport default profile;","map":null,"metadata":{},"sourceType":"module"}